# API 文档总览

## 🚀 系统概述

这是一个基于.NET Core 构建的企业级管理系统 API，采用微服务架构设计，提供完整的用户管理、认证授权、文件管理和数据字典等核心功能。

## 📚 API 模块文档

### 核心模块

| 模块            | 描述                          | 文档链接                                    |
| --------------- | ----------------------------- | ------------------------------------------- |
| 🔐 **认证管理** | 用户登录、令牌管理、安全认证  | [认证管理 API.md](./认证管理API.md)         |
| 👥 **用户管理** | 用户 CRUD、分页查询、权限管理 | [用户管理 API.md](./用户管理API.md)         |
| 📁 **文件管理** | 文件上传、下载、图片压缩      | [文件管理 API.md](./文件管理API.md)         |
| 📖 **数据字典** | 字典管理、树形结构、缓存策略  | [数据字典管理 API.md](./数据字典管理API.md) |

## 🏗️ 技术架构

### 核心技术栈

-   **.NET Core**: 跨平台后端框架
-   **Entity Framework Core**: ORM 数据访问层
-   **JWT 认证**: 无状态身份验证
-   **反射动态查询**: 智能查询构建器
-   **文件存储**: 本地文件系统（支持扩展云存储）

### 架构特性

-   🎯 **RESTful 设计**: 遵循 REST API 设计规范
-   🔒 **安全认证**: 基于 JWT 的无状态认证
-   📊 **统一响应**: 标准化的 API 响应格式
-   🚦 **错误处理**: 完善的异常处理机制
-   📝 **操作审计**: 完整的操作日志记录

## 🔧 快速开始

### 1. 环境要求

-   .NET 6.0 或更高版本
-   SQL Server 2019 或更高版本
-   Visual Studio 2022 或 Visual Studio Code

### 2. 基础配置

```json
{
    "ConnectionStrings": {
        "DefaultConnection": "Server=localhost;Database=MyFirstApi;Trusted_Connection=true;"
    },
    "JwtSettings": {
        "SecretKey": "your-secret-key",
        "Issuer": "MyFirstApi",
        "Audience": "MyFirstApi",
        "ExpirationHours": 24
    }
}
```

### 3. 认证流程

```bash
# 1. 用户登录获取Token
POST /api/auth/login
{
  "empCode": "your-employee-code",
  "password": "your-password"
}

# 2. 在后续请求中携带Token
Authorization: Bearer {your-access-token}
```

## 📋 API 规范

### 请求格式

```http
POST /api/{module}/{action}
Content-Type: application/json
Authorization: Bearer {token}

{
  "field1": "value1",
  "field2": "value2"
}
```

### 统一响应格式

```json
{
    "statusCode": 200,
    "message": "操作成功",
    "data": {},
    "success": true
}
```

### 分页查询格式

```json
{
    "items": [],
    "totalCount": 100,
    "pageIndex": 1,
    "pageSize": 10,
    "totalPages": 10
}
```

## 🎯 核心功能特性

### 反射动态查询

-   **智能映射**: 基于 DTO 属性自动生成查询条件
-   **类型安全**: 支持多种数据类型的自动识别
-   **性能优化**: Expression 树编译为高效委托

### 文件管理系统

-   **多格式支持**: 文档、图片、压缩包等
-   **智能压缩**: 图片自动压缩优化
-   **安全存储**: 按时间分类的安全存储策略

### 数据字典管理

-   **树形结构**: 支持多级层次结构
-   **缓存策略**: 高性能的缓存机制
-   **动态配置**: 灵活的业务配置支持

## 🔐 安全特性

### 认证授权

-   **JWT 令牌**: 无状态的安全认证
-   **令牌刷新**: 自动令牌续期机制
-   **黑名单机制**: 令牌失效管理

### 数据安全

-   **逻辑删除**: 数据安全删除策略
-   **操作审计**: 完整的操作记录
-   **权限控制**: 基于角色的访问控制

### 文件安全

-   **类型验证**: 严格的文件类型检查
-   **大小限制**: 防止恶意文件上传
-   **访问控制**: 基于权限的文件访问

## 🚦 错误码规范

| 状态码 | 说明       | 适用场景       |
| ------ | ---------- | -------------- |
| 200    | 操作成功   | 正常业务处理   |
| 400    | 请求错误   | 参数验证失败   |
| 401    | 未授权     | 令牌无效或过期 |
| 403    | 无权限     | 权限不足       |
| 404    | 资源不存在 | 数据未找到     |
| 500    | 服务器错误 | 系统内部错误   |

## 📊 性能优化

### 数据库优化

-   **索引策略**: 合理的数据库索引设计
-   **查询优化**: Entity Framework 查询优化
-   **连接池**: 数据库连接池管理

### 缓存策略

-   **内存缓存**: 热点数据内存缓存
-   **分布式缓存**: Redis 分布式缓存
-   **缓存更新**: 智能缓存失效机制

### 并发控制

-   **异步处理**: 大量异步操作支持
-   **资源管理**: 合理的资源使用策略
-   **负载均衡**: 支持水平扩展

## 🛠️ 开发指南

### 代码规范

-   **命名约定**: 遵循 C#命名规范
-   **注释标准**: 完整的 XML 文档注释
-   **代码审查**: 严格的代码审查流程

### 测试策略

-   **单元测试**: 核心业务逻辑单元测试
-   **集成测试**: API 接口集成测试
-   **性能测试**: 关键接口性能测试

### 部署指南

-   **容器化**: Docker 容器化部署
-   **环境隔离**: 开发、测试、生产环境隔离
-   **监控告警**: 完善的监控告警机制

## 📞 支持与反馈

-   **问题反馈**: 通过 Issue 提交问题
-   **功能建议**: 欢迎提出功能改进建议
-   **技术支持**: 提供完整的技术文档和支持

---

> 📝 **文档维护**: 本文档会随着系统功能的更新而持续维护，请关注最新版本。

> 🔄 **版本更新**: 当前 API 版本 v1.0，如有重大更新会在此说明。
